// Generated by CoffeeScript 1.6.3
(function() {
  var createKarmaFileList, fs, path, phantom, run, runKarma, runPhantom, utils;

  fs = require('fs');

  path = require('path');

  utils = require('./utils');

  phantom = require('./phantom');

  run = function(apps, options) {
    var app, _i, _len, _results;
    if (options == null) {
      options = {};
    }
    _results = [];
    for (_i = 0, _len = apps.length; _i < _len; _i++) {
      app = apps[_i];
      if (app.name !== 'common') {
        _results.push(runPhantom(app, options));
      }
    }
    return _results;
  };

  runPhantom = function(app, options) {
    var testFile;
    if (options == null) {
      options = {};
    }
    testFile = app.getTestPackage().getTestIndexFile();
    return phantom(testFile, "passOrFail");
  };

  runKarma = function(app, options) {
    var testConfig;
    if (options == null) {
      options = {};
    }
    testConfig = fs.existsSync(options.config) && fs.realpathSync(options.config);
    testConfig || (testConfig = {
      singleRun: options.singleRun || true,
      basePath: options.basePath,
      reporters: ['progress'],
      logLevel: 'info',
      frameworks: [options.framework],
      browsers: options.browser && options.browser.split(/[ ,]+/) || ['PhantomJS'],
      files: createKarmaFileList(app)
    });
    return require('karma').server.start(testConfig);
  };

  createKarmaFileList = function(app) {};

  module.exports.run = run;

}).call(this);
